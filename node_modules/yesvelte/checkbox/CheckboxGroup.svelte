<script>import { get_current_component } from "svelte/internal";
import { El } from "../el";
import Checkbox from "./Checkbox.svelte";
export let color = void 0;
export let componentName = "checkbox-group";
export let inline = void 0;
export let items = void 0;
export let name = void 0;
export let reverse = void 0;
export let value = void 0;
export let key = void 0;
const components = [
  { component: get_current_component(), except: [] },
  ...$$props.components ?? []
];
let element;
let props = {};
$:
  props = {
    inline,
    name: name ?? element?.id,
    color,
    reverse
  };
$:
  getKey = (item) => {
    if (typeof item === "object") {
      if (key) {
        return typeof key === "string" ? item[key] : key(item);
      }
      return JSON.stringify(item);
    } else {
      return item;
    }
  };
function parse(item) {
  if (typeof items[0] === "object" && !key) {
    return JSON.parse(item);
  }
  return item;
}
function onChange(event) {
  if (value === void 0)
    value = [];
  if (items != void 0 && items?.length > 0) {
    const selectedValue = parse(event.target?.value);
    const selectedChecked = event.target?.checked;
    if (selectedChecked) {
      value.push(selectedValue);
    } else {
      var _index = value.findIndex((x) => getKey(x) === getKey(selectedValue));
      if (_index !== -1) {
        value.splice(_index, 1);
      }
    }
    value = value;
  }
}
function isSelected(item) {
  return (value?.findIndex((x) => getKey(x) === getKey(item)) ?? -1) > -1;
}
</script>

<El {components} {componentName} bind:element {...$$restProps}>
	{#if items}
		{#each items as item, index (index)}
			<Checkbox {...props} value={getKey(item)} checked={isSelected(item)} on:change={onChange}>
				<slot {index} {item}>{item}</slot>
			</Checkbox>
		{/each}
	{:else}
		<slot />
	{/if}
</El>
